{"ast":null,"code":"import React,{useState,useEffect}from'react';import{toCardFilename}from'../utils/card-utils';import'./Hand.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Hand(_ref){let{cards,onSubmit,gameStatus}=_ref;const[unassigned,setUnassigned]=useState([]);const[head,setHead]=useState([]);const[middle,setMiddle]=useState([]);const[tail,setTail]=useState([]);const[selectedCards,setSelectedCards]=useState([]);useEffect(()=>{setUnassigned(cards);// Reset state when new cards are dealt\nsetHead([]);setMiddle([]);setTail([]);setSelectedCards([]);},[cards]);const handleCardClick=(card,area)=>{// Toggle selection\nif(selectedCards.includes(card)){setSelectedCards(selectedCards.filter(c=>c!==card));}else{setSelectedCards([...selectedCards,card]);}};const moveSelectedTo=targetArea=>{if(selectedCards.length===0)return;// Logic to move cards between areas (unassigned, head, middle, tail)\n// This is a simplified version. A full implementation would need more robust state management.\nlet newUnassigned=[...unassigned];let newHead=[...head];let newMiddle=[...middle];let newTail=[...tail];// Remove from all areas first\nnewUnassigned=newUnassigned.filter(c=>!selectedCards.includes(c));newHead=newHead.filter(c=>!selectedCards.includes(c));newMiddle=newMiddle.filter(c=>!selectedCards.includes(c));newTail=newTail.filter(c=>!selectedCards.includes(c));// Add to the target area\nif(targetArea==='head')newHead.push(...selectedCards);if(targetArea==='middle')newMiddle.push(...selectedCards);if(targetArea==='tail')newTail.push(...selectedCards);if(targetArea==='unassigned')newUnassigned.push(...selectedCards);setUnassigned(newUnassigned);setHead(newHead);setMiddle(newMiddle);setTail(newTail);setSelectedCards([]);// Clear selection\n};const renderCard=(card,area)=>{const cardFilename=toCardFilename(card);const isSelected=selectedCards.includes(card);return/*#__PURE__*/_jsx(\"img\",{src:`/assets/cards/${cardFilename}.svg`,alt:card,className:`card-img ${isSelected?'selected':''}`,onClick:()=>handleCardClick(card,area)},card);};const renderDun=(cards,areaName,limit)=>/*#__PURE__*/_jsxs(\"div\",{className:\"dun-area\",onClick:()=>moveSelectedTo(areaName),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dun-header\",children:[areaName.toUpperCase(),\" (\",cards.length,\"/\",limit,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-container\",children:cards.map(card=>renderCard(card,areaName))})]});const isSubmitDisabled=head.length!==3||middle.length!==5||tail.length!==5||gameStatus!=='playing';const handleSubmit=()=>{if(!isSubmitDisabled){onSubmit({head,middle,tail});}};if(gameStatus!=='playing'&&gameStatus!=='dealing'){return/*#__PURE__*/_jsx(\"div\",{className:\"hand-container-hidden\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"hand-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"unassigned-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dun-header\",children:[\"\\u4F60\\u7684\\u624B\\u724C (\",unassigned.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-container\",children:unassigned.map(card=>renderCard(card,'unassigned'))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"duns-container\",children:[renderDun(head,'head',3),renderDun(middle,'middle',5),renderDun(tail,'tail',5)]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-submit-hand\",onClick:handleSubmit,disabled:isSubmitDisabled,children:\"\\u63D0\\u4EA4\\u724C\\u7EC4\"})]});}export default Hand;","map":{"version":3,"names":["React","useState","useEffect","toCardFilename","jsx","_jsx","jsxs","_jsxs","Hand","_ref","cards","onSubmit","gameStatus","unassigned","setUnassigned","head","setHead","middle","setMiddle","tail","setTail","selectedCards","setSelectedCards","handleCardClick","card","area","includes","filter","c","moveSelectedTo","targetArea","length","newUnassigned","newHead","newMiddle","newTail","push","renderCard","cardFilename","isSelected","src","alt","className","onClick","renderDun","areaName","limit","children","toUpperCase","map","isSubmitDisabled","handleSubmit","disabled"],"sources":["/home/user/ssk/frontend/src/components/Hand.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { toCardFilename } from '../utils/card-utils';\nimport './Hand.css';\n\nfunction Hand({ cards, onSubmit, gameStatus }) {\n    const [unassigned, setUnassigned] = useState([]);\n    const [head, setHead] = useState([]);\n    const [middle, setMiddle] = useState([]);\n    const [tail, setTail] = useState([]);\n    const [selectedCards, setSelectedCards] = useState([]);\n\n    useEffect(() => {\n        setUnassigned(cards);\n        // Reset state when new cards are dealt\n        setHead([]);\n        setMiddle([]);\n        setTail([]);\n        setSelectedCards([]);\n    }, [cards]);\n\n    const handleCardClick = (card, area) => {\n        // Toggle selection\n        if (selectedCards.includes(card)) {\n            setSelectedCards(selectedCards.filter(c => c !== card));\n        } else {\n            setSelectedCards([...selectedCards, card]);\n        }\n    };\n\n    const moveSelectedTo = (targetArea) => {\n        if (selectedCards.length === 0) return;\n\n        // Logic to move cards between areas (unassigned, head, middle, tail)\n        // This is a simplified version. A full implementation would need more robust state management.\n        \n        let newUnassigned = [...unassigned];\n        let newHead = [...head];\n        let newMiddle = [...middle];\n        let newTail = [...tail];\n\n        // Remove from all areas first\n        newUnassigned = newUnassigned.filter(c => !selectedCards.includes(c));\n        newHead = newHead.filter(c => !selectedCards.includes(c));\n        newMiddle = newMiddle.filter(c => !selectedCards.includes(c));\n        newTail = newTail.filter(c => !selectedCards.includes(c));\n\n        // Add to the target area\n        if (targetArea === 'head') newHead.push(...selectedCards);\n        if (targetArea === 'middle') newMiddle.push(...selectedCards);\n        if (targetArea === 'tail') newTail.push(...selectedCards);\n        if (targetArea === 'unassigned') newUnassigned.push(...selectedCards);\n\n        setUnassigned(newUnassigned);\n        setHead(newHead);\n        setMiddle(newMiddle);\n        setTail(newTail);\n        setSelectedCards([]); // Clear selection\n    };\n\n    const renderCard = (card, area) => {\n        const cardFilename = toCardFilename(card);\n        const isSelected = selectedCards.includes(card);\n        return (\n            <img\n                key={card}\n                src={`/assets/cards/${cardFilename}.svg`}\n                alt={card}\n                className={`card-img ${isSelected ? 'selected' : ''}`}\n                onClick={() => handleCardClick(card, area)}\n            />\n        );\n    };\n\n    const renderDun = (cards, areaName, limit) => (\n        <div className=\"dun-area\" onClick={() => moveSelectedTo(areaName)}>\n            <div className=\"dun-header\">{areaName.toUpperCase()} ({cards.length}/{limit})</div>\n            <div className=\"card-container\">\n                {cards.map(card => renderCard(card, areaName))}\n            </div>\n        </div>\n    );\n    \n    const isSubmitDisabled = head.length !== 3 || middle.length !== 5 || tail.length !== 5 || gameStatus !== 'playing';\n\n    const handleSubmit = () => {\n        if (!isSubmitDisabled) {\n            onSubmit({ head, middle, tail });\n        }\n    };\n\n    if (gameStatus !== 'playing' && gameStatus !== 'dealing') {\n        return <div className=\"hand-container-hidden\"></div>;\n    }\n\n    return (\n        <div className=\"hand-container\">\n            <div className=\"unassigned-area\">\n                <div className=\"dun-header\">你的手牌 ({unassigned.length})</div>\n                <div className=\"card-container\">\n                    {unassigned.map(card => renderCard(card, 'unassigned'))}\n                </div>\n            </div>\n            <div className=\"duns-container\">\n                {renderDun(head, 'head', 3)}\n                {renderDun(middle, 'middle', 5)}\n                {renderDun(tail, 'tail', 5)}\n            </div>\n            <button\n                className=\"btn-submit-hand\"\n                onClick={handleSubmit}\n                disabled={isSubmitDisabled}\n            >\n                提交牌组\n            </button>\n        </div>\n    );\n}\n\nexport default Hand;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}